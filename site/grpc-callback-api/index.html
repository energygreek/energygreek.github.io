
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A new project generated from the default template project.">
      
      
        <meta name="author" content="<your name here>">
      
      
      
        <link rel="prev" href="../grammer-noun-of-noun/">
      
      
        <link rel="next" href="../grpc-learning/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="zensical-0.0.5">
    
    
      
        <title>grpc callback api - Documentation</title>
      
    
    
      
        
      
      <link rel="stylesheet" href="../assets/stylesheets/modern/main.1357c24d.min.css">
      
        
          
        
        <link rel="stylesheet" href="../assets/stylesheets/modern/palette.dfe2e883.min.css">
      
      
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
  
  <style>:root{}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#grpc-callback-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Documentation" class="md-header__button md-logo" aria-label="Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-book-open" viewBox="0 0 24 24"><path d="M12 7v14M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-menu" viewBox="0 0 24 24"><path d="M4 5h16M4 12h16M4 19h16"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              grpc callback api
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="none" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-sun" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="none" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-moon" viewBox="0 0 24 24"><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-search" viewBox="0 0 24 24"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog" aria-label="Search">
  <button type="button" class="md-search__button">
    Search
  </button>
</div>
      
    
    <div class="md-header__source">
      
    </div>
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Documentation" class="md-nav__button md-logo" aria-label="Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-book-open" viewBox="0 0 24 24"><path d="M12 7v14M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"/></svg>

    </a>
    Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI%E5%AF%BC%E6%95%B0%E4%B8%8D%E5%AE%9A%E7%A7%AF%E5%88%86%E5%92%8C%E5%AE%9A%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    计算函数x^2在区间0到1之间的积分
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../EVS_dec%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EVS_dec使用方法
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Install-KVM-on-Debian-of-aarch64-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install KVM on Debian of aarch64 architecture
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Learn%20English%20Conjunction%20words/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    连词和复合句
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Learn%20GPIO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learn GPIO
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Learn%20Midi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learn Midi
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Linux-Interrupts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux 中断请求
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Non-constant%20time%20of%20comparation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Non-constant time comparison bug
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../a-FakeIt-issue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    记一个FakeIt使用问题
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../acronyms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    database acronyms
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../adb%20remote%20forward/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    adb remote forward
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../add-printer-in-linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    add printer in linux
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced-marco-in-c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    advanced marco in c
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../airplay-receiver-in-Linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux模拟airplay接收器
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aliyun-dynamic-dns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    阿里云动态设置 dns
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../amrnb-and-amrwb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    amrnb和amrwb的编解码
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aria2c%20usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    aria2c usage
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../bash-envioirment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bash 环境变量
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../bash-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bash learning
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../bash-safe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bash safety
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../binary-tree-traversal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    binary tree traversal
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../boost-di-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    boost::di learning
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../buffer-cache-too-high/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    buffer-cache too high
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../buffer-stdbuf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    输出缓冲和stdbuf
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../build-a-spider/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    爬虫
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../c-signal-and-exception/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    c++ 信号和异常
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calculus%20learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    calculus learning
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../carry-bit-overflow-bit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    进位位和溢出位(carry bit/overflow bit)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../change%20hostname%20of%20pve%20and%20vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    change hostname of pve and vm
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cmake-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cmake learning
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cmake-precompile-header/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cmake precompile header
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure%20dns%20for%20pve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    为pve配置dns
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../connect_raspberry_to_arduino_via_i2c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    connect raspberry and arduino via i2c
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../container-tech/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    容器的命名空间
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cpp-cas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CPP原子操作
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cpp-template-programing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    模板编程
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C++ 小技巧
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../crash-boot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    crash boot
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../create%20cli%20use%20typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    implement cli use typescript
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-loop-block/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    在文件系统之上再创一个文件系统
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../crontab-manual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux定时器
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ddns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ddns
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../defualt%20route%20in%20linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    defualt route in linux
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker-network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    docker network
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker-overlay-filesystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    docker overlay filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    docker storage
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../download%20music%20to%20ipod%20shuffle%204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    download music to ipod shuffle 4
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dp-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DP 四板斧
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dpdk%20test%20speed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dpdk-testpmd to test NIC speed
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../effective-cpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    effective cpp
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../entrypointandcmdindockerfile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dockerfile 中ENTRYPOINT和CMD的区别
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../esp32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    玩转ESP32
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ffmpeg-AVCodecContext/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    libavcodec使用
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../firefox-manual-add-search-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    firefox 启用手动添加搜索引擎
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../format-in-c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    在c语言中打印支持不同类型变量
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../gcc-optimize-memory-function/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gcc 会优化很多内存相关的调用
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../gdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gdb调试容器内的进程
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../generate%20compile_commands%20json/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ways of generating compile command json file
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../generate%20random%20number/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    generate random number
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../get%20fd%20in%20the%20other%20process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    获取其他进程打开的文件描述符
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../gitcommand/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Git的重要操作
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../go-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    go 学习笔记
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../grammer-noun-of-noun/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    语法规则-名词修饰名词
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    grpc callback api
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    grpc callback api
  

    
  </span>
  
  

      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#c-callback-based-asynchronous-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        C++ callback-based asynchronous API
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      
        Abstract
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#related-proposals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related proposals
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proposal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reactor-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reactor model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unary-rpc-shortcuts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unary RPC shortcuts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#servercontext-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ServerContext extensions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced topics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-managed-server-memory-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Application-managed server memory allocation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic-non-code-generated-services" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generic (non-code-generated) services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#per-method-specification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Per-method specification
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rationale" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rationale
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-issues-if-applicable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Open issues (if applicable)
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../grpc-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    grpc 学习
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guitar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    吉他学习
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hash
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../heap-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    堆排序
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../huawei-change-rom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    huawei change rom
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../huawei-unlock-bootloader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    huawei unlock bootloader
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ibus-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ibus-setup
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install-k8s-cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    搭建k8s集群
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install-wordpress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    安装wordpress记录
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ipsec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ipsec 和 vowifi
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../iptables-forward/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux创建热点
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../iwd-ap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    使用iwd创建ap热点
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../kmp-substring-searching-algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kmp 子串查找算法
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../learn%20fastapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    learn fastapi
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../learn%20geo%20ip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    learn geo ip
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../learn%20ip%20header/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    learn ip header
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../learning%20lisp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    arc 是lisp一种方言，通用编程语言。
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux-perm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    linux 权限位
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux-reset-password/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rhel系列修改密码
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lvm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LVM 功能介绍
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lxc%20enable%20tun%20device/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    lxc enable tun device
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mail-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mail setup
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../manage-temporary-file-with-systemd-tmpfiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    使用systemd-tmpfiles来管理临时文件
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../markdown/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.27 19.385H1.73A1.73 1.73 0 0 1 0 17.655V6.345a1.73 1.73 0 0 1 1.73-1.73h20.54A1.73 1.73 0 0 1 24 6.345v11.308a1.73 1.73 0 0 1-1.73 1.731zM5.769 15.923v-4.5l2.308 2.885 2.307-2.885v4.5h2.308V8.078h-2.308l-2.307 2.885-2.308-2.885H3.46v7.847zM21.232 12h-2.309V8.077h-2.307V12h-2.308l3.461 4.039z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Markdown in 5min
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    浅谈内存管理
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../miniserve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    网络文件浏览器
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mutex-error/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mutex error
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../my-urxvt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    urxvt配置
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-statements-execution-order/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mysql sql语句优先级
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../nginx-fails-to-connect-to-unix-socket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    记录在部署一个nginx fastcgi 项目时失败， fastcgi 通过unix socket 通讯
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notes
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../oauth2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    oauth2 认证说明
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../optarg-in-gdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gdb中打印optarg永远是0x0, 但是依然能传递参数
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../package-problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    背包问题
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../passthrough/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pci passthrough
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pessimistic-lock-optimistic-lock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    乐观锁悲观锁
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pointer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    c语言中pointer和array的区别
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../power-and-logarithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    指数和对数
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pricious/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    编程语言中小数精度问题
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pve-usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pve入门
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../python-arguement-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    python arguement types
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../python-namespace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    namespace 介绍
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../python-package-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    python package2
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../python-package/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    python 包的管理
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../python-setuptools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    setuptools 是disutils 的升级版。
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../python-wraper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    python decoder 介绍
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rancher-learn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rancher-learn
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reg-match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    使用正则来校验输入合法性
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../register/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    c 中 register 关键字
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../resize-windows-disk-pve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pve中给windows扩容
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rhce8-question/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    记录一下rhce8上课笔记
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rotate-list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    单向链表翻转算法
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../run%20docker%20in%20pve%20vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    difference of lxc container and docker container
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../run%20vllm%20locally/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    run vllm Qwen3 locally
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sdcc-compile-for-51/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    在Linux下使用sdcc进行单片机编译
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sed-vim-difference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sed和vim替换文本的小区别
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../segmentation-fault-in-dmesg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    segfault in dmesg
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../serialized-and-deserialize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    序列化和反序列化
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-printer-use-avahi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    使用avahi将传统打印机支持无线打印
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-sftp-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    setup sftp service
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-vue2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    初始化vue2
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../shared-pointer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    智能指针
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../shell-file-operation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    shell 中文件操作接口
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../shell-scripts-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    shell 笔记
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../small-string-optimization-in-c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    c++的basic_string优化
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../spdlog-learn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    spdlog learning
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    数据库优化总结
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql-operator-priority/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL优先级问题
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../static-compile-warning-if-namespace-resolving-function-used/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    static compile warning if namespace resolving function used
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage-duration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    c++ 存储周期、链接和作用域
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../streaming-h264-with-rtp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    streaming h264 with rtp
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../subprocess/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    linux子进程使用方法
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../system-calls-method/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    system calls method
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../systemd%20socket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    systemd socket 服务
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../systemd-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    创建 systemd 服务
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tailcale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tailscale 使用记录
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../temporary-object-and-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    右值, 临时变量与引用
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../text%20process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux 文本处理三剑客
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../thread-local-variable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    线程局部变量
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../udp-loader-balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    udp 的端口复用实现负载均衡
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../udp-statistic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    udp 查看统计的方法
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../use-mdns-in-systemd-networkd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    使用systemd-resolved的mdns
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../virtio%20nic%20configure%20multi-queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    virtio nic configure multi-queue
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../virtio-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    virtio learning
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnerable-case/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    主要收集一些常见缺陷和加固方法
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ways-to-use-third-party-library-in-cmake/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cmake 使用第三方库
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../website%20status%20announce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    website status announce
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../weechat-manual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    weechat 使用方法
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../wifi-tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    随身wifi工具刷机
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_155" >
        
          
          <label class="md-nav__link" for="__nav_155" id="__nav_155_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Drafts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_155_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_155">
            <span class="md-nav__icon md-icon"></span>
            
  
    Drafts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../drafts/familly%20funcion%20of%20exec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    exec family functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../drafts/isatty/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    isatty 打印日志
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../drafts/learn%20asm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    asm learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../drafts/learning%20dtmf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    非常渴望学习FFT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_156" >
        
          
          <label class="md-nav__link" for="__nav_156" id="__nav_156_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Rhce8
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_156_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_156">
            <span class="md-nav__icon md-icon"></span>
            
  
    Rhce8
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rhce8/rhce8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rhce8 考试记录
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rhce8/rhce_course_name/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    00 Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#c-callback-based-asynchronous-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        C++ callback-based asynchronous API
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      
        Abstract
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#related-proposals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related proposals
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proposal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reactor-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reactor model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unary-rpc-shortcuts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unary RPC shortcuts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#servercontext-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ServerContext extensions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced topics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-managed-server-memory-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Application-managed server memory allocation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic-non-code-generated-services" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generic (non-code-generated) services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#per-method-specification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Per-method specification
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rationale" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rationale
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-issues-if-applicable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Open issues (if applicable)
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


              
              <article class="md-content__inner md-typeset">
                
                  

<h1 id="grpc-callback-api">grpc callback api<a class="headerlink" href="#grpc-callback-api" title="Permanent link">&para;</a></h1>
<h2 id="c-callback-based-asynchronous-api">C++ callback-based asynchronous API<a class="headerlink" href="#c-callback-based-asynchronous-api" title="Permanent link">&para;</a></h2>
<ul>
<li>Author(s): vjpai, sheenaqotj, yang-g, zhouyihaiding</li>
<li>Approver: markdroth</li>
<li>Status: Proposed</li>
<li>Implemented in: <a href="https://github.com/grpc/grpc/projects/12">https://github.com/grpc/grpc/projects/12</a></li>
<li>Last updated: March 22, 2021</li>
<li>Discussion at <a href="https://groups.google.com/g/grpc-io/c/rXLdWWiosWg">https://groups.google.com/g/grpc-io/c/rXLdWWiosWg</a></li>
</ul>
<h2 id="abstract">Abstract<a class="headerlink" href="#abstract" title="Permanent link">&para;</a></h2>
<p>Provide an asynchronous gRPC API for C++ in which the completion of RPC actions in the library will result in callbacks to user code,</p>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<p>Since its initial release, gRPC has provided two C++ APIs:</p>
<ul>
<li>Synchronous API</li>
<li>All RPC actions (such as unary calls, streaming reads, streaming writes, etc.) block for completion</li>
<li>Library provides a thread-pool so that each incoming server RPC executes its method handler in its own thread</li>
<li>Completion-queue-based (aka CQ-based) asynchronous API</li>
<li>Application associates each RPC action that it initiates with a tag</li>
<li>The library performs each RPC action</li>
<li>The library posts the tag of a completed action onto a completion queue</li>
<li>The application must poll the completion queue to determine which asynchronously-initiated actions have completed</li>
<li>The application must provide and manage its own threads</li>
<li>Server RPCs don't have any library-invoked method handler; instead the application is responsible for executing the actions for an RPC once it is notified of an incoming RPC via the completion queue</li>
</ul>
<p>The goal of the synchronous version is to be easy to program. However, this comes at the cost of high thread-switching overhead and high thread storage for systems with many concurrent RPCs. On the other hand, the asynchronous API allows the application full control over its threading and thus can scale further. The biggest problem with the asynchronous API is that it is just difficult to use. Server RPCs must be explicitly requested, RPC polling must be explicitly controlled by the application, lifetime management is complicated, etc. These have proved sufficiently difficult that the full features of the asynchronous API are basically never used by applications. Even if one can use the async API correctly, it also presents challenges in deciding how many completion queues to use and how many threads to use for polling them, as one can either optimize for reducing thread hops, avoiding stranding, reducing CQ contention, or improving locality. These goals are often in conflict and require substantial tuning.</p>
<h3 id="related-proposals">Related proposals<a class="headerlink" href="#related-proposals" title="Permanent link">&para;</a></h3>
<ul>
<li>The C++ callback API has an implementation that is built on top of a new <a href="https://github.com/grpc/proposal/pull/181">callback completion queue in core</a>. There is also another implementation, discussed <a href="#implementation">below</a>.</li>
<li>The API structure has substantial similarities to the gRPC-Node and gRPC-Java APIs.</li>
</ul>
<h2 id="proposal">Proposal<a class="headerlink" href="#proposal" title="Permanent link">&para;</a></h2>
<p>The callback API is designed to have the performance and thread scalability of an asynchronous API without the burdensome programming model of the completion-queue-based model. In particular, the following are fundamental guiding principles of the API:</p>
<ul>
<li>Library directly calls user-specified code at the completion of RPC actions. This user code is run from the library's own threads, so it is very important that it must not wait for completion of any blocking operations (e.g., condition variable waits, invoking synchronous RPCs, blocking file I/O).</li>
<li>No explicit polling required for notification of completion of RPC actions.</li>
<li>In practice, these requirements mean that there must be a library-controlled poller for monitoring such actions. This is discussed in more detail in the <a href="#implementation">Implementation</a> section below.</li>
<li>As in the synchronous API, server RPCs have an application-defined method handler function as part of their service definition. The library invokes this method handler when a new server RPC starts.</li>
<li>Like the synchronous API and unlike the completion-queue-based asynchronous API, there is no need for the application to "request" new server RPCs. Server RPC context structures will be allocated and have their resources allocated as and when RPCs arrive at the server.</li>
</ul>
<h3 id="reactor-model">Reactor model<a class="headerlink" href="#reactor-model" title="Permanent link">&para;</a></h3>
<p>The most general form of the callback API is built around a <em>reactor</em> model. Each type of RPC has a reactor base class provided by the library. These types are:</p>
<ul>
<li><code>ClientUnaryReactor</code> and <code>ServerUnaryReactor</code> for unary RPCs</li>
<li><code>ClientBidiReactor</code> and <code>ServerBidiReactor</code> for bidi-streaming RPCs</li>
<li><code>ClientReadReactor</code> and <code>ServerWriteReactor</code> for server-streaming RPCs</li>
<li><code>ClientWriteReactor</code> and <code>ServerReadReactor</code> for client-streaming RPCs</li>
</ul>
<p>Client RPC invocations from a stub provide a reactor pointer as one of their arguments, and the method handler of a server RPC must return a reactor pointer.</p>
<p>These base classes provide three types of methods:</p>
<ol>
<li>Operation-initiation methods: start an asynchronous activity in the RPC. These are methods provided by the class and are not virtual. These are invoked by the application logic. All of these have a <code>void</code> return type. The <code>ReadMessageType</code> below is the request type for a server RPC and the response type for a client RPC; the <code>WriteMessageType</code> is the response type for a server RPC or the request type for a client RPC.</li>
<li><code>void StartCall()</code>: (<em>Client only</em>) Initiates the operations of a call from the client, including sending any client-side initial metadata associated with the RPC. Must be called exactly once. No reads or writes will actually be started until this is called (i.e., any previous calls to <code>StartRead</code>, <code>StartWrite</code>, or <code>StartWritesDone</code> will be queued until <code>StartCall</code> is invoked). This operation is not needed at the server side since streaming operations at the server are released from backlog automatically by the library as soon as the application returns a reactor from the method handler, and because there is a separate method just for sending initial metadata.</li>
<li><code>void StartSendInitialMetadata()</code>: (<em>Server only</em>) Sends server-side initial metadata. To be used in cases where initial metadata should be sent without sending a message. Optional; if not called, initial metadata will be sent when <code>StartWrite</code> or <code>Finish</code> is called. May not be invoked more than once or after <code>StartWrite</code> or <code>Finish</code> has been called. This does not exist at the client because sending initial metadata is part of <code>StartCall</code>.</li>
<li><code>void StartRead(ReadMessageType*)</code>: Starts a read of a message into the object pointed to by the argument. <code>OnReadDone</code> will be invoked when the read is complete. Only one read may be outstanding at any given time for an RPC (though a read and a write can be concurrent with each other). If this operation is invoked by a client before calling <code>StartCall</code> or by a server before returning from the method handler, it will be queued until one of those events happens and will not actually trigger any activity or reactions until it is thereby released from the queue.</li>
<li><code>void StartWrite(const WriteMessageType*)</code>: Starts a write of the object pointed to by the argument. <code>OnWriteDone</code> will be invoked when the write is complete. Only one write may be outstanding at any given time for an RPC (though a read and a write can be concurrent with each other).  As with <code>StartRead</code>, if this operation is invoked by a client before calling <code>StartCall</code> or by a server before returning from the method handler, it will be queued until one of those events happens and will not actually trigger any activity or reactions until it is thereby released from the queue.</li>
<li><code>void StartWritesDone()</code>: (<em>Client only</em>) For client RPCs to indicate that there are no more writes coming in this stream.  <code>OnWritesDoneDone</code> will be invoked when this operation is complete. This causes future read operations on the server RPC to indicate that there is no more data available. Highly recommended but technically optional; may not be called more than once per call.  As with <code>StartRead</code> and <code>StartWrite</code>, if this operation is invoked by a client before calling <code>StartCall</code> or by a server before returning from the method handler, it will be queued until one of those events happens and will not actually trigger any activity or reactions until it is thereby released from the queue.</li>
<li><code>void Finish(Status)</code>: (<em>Server only</em>) Sends completion status to the client, asynchronously. Must be called exactly once for all server RPCs, even for those that have already been cancelled. No further operation-initiation methods may be invoked after <code>Finish</code>.</li>
<li>Operation-completion reaction methods: notification of completion of asynchronous RPC activity. These are all virtual methods that default to an empty function (i.e., <code>{}</code>) but may be overridden by the application's reactor definition. These are invoked by the library. All of these have a <code>void</code> return type. Most take a <code>bool ok</code> argument to indicate whether the operation completed "normally," as explained below.</li>
<li><code>void OnReadInitialMetadataDone(bool ok)</code>: (<em>Client only</em>) Invoked by the library to notify that the server has sent an initial metadata response to a client RPC. If <code>ok</code> is true, then the RPC received initial metadata normally. If it is false, there is no initial metadata either because the call has failed or because the call received a trailers-only response (which means that there was no actual message and that any information normally sent in initial metadata has been dispatched instead to trailing metadata, which is allowed in the gRPC HTTP/2 transport protocol). This reaction is automatically invoked by the library for RPCs of all varieties; it is uncommonly used as an application-defined reaction however.</li>
<li><code>void OnReadDone(bool ok)</code>: Invoked by the library in response to a <code>StartRead</code> operation. The <code>ok</code> argument indicates whether a message was read as expected. A false <code>ok</code> could mean a failed RPC (e.g., cancellation) or a case where no data is possible because the other side has already ended its writes (e.g., seen at the server-side after the client has called <code>StartWritesDone</code>).</li>
<li><code>void OnWriteDone(bool ok)</code>: Invoked by the library in response to a <code>StartWrite</code> operation. The <code>ok</code> argument that indicates whether the write was successfully sent; a false value indicates an RPC failure.</li>
<li><code>void OnWritesDoneDone(bool ok)</code>: (<em>Client only</em>) Invoked by the library in response to a <code>StartWritesDone</code> operation. The bool <code>ok</code> argument that indicates whether the writes-done operation was successfully completed; a false value indicates an RPC failure.</li>
<li><code>void OnCancel()</code>: (<em>Server only</em>) Invoked by the library if an RPC is canceled before it has a chance to successfully send status to the client side. The reaction may be used for any cleanup associated with cancellation or to guide the behavior of other parts of the system (e.g., by setting a flag in the service logic associated with this RPC to stop further processing since the RPC won't be able to send outbound data anyway). Note that servers must call <code>Finish</code> even for RPCs that have already been canceled as this is required to cleanup all their library state and move them to a state that allows for calling <code>OnDone</code>.</li>
<li><code>void OnDone(const Status&amp;)</code> at the client, <code>void OnDone()</code> at the server: Invoked by the library when all outstanding and required RPC operations are completed for a given RPC. For the client-side, it additionally provides the status of the RPC (either as sent by the server with its <code>Finish</code> call or as provided by the library to indicate a failure), in which case the signature is <code>void OnDone(const Status&amp;)</code>. The server version has no argument, and thus has a signature of <code>void OnDone()</code>. Should be used for any application-level RPC-specific cleanup.</li>
<li><em>Thread safety</em>: the above calls may take place concurrently, except that <code>OnDone</code> will always take place after all other reactions. No further RPC operations are permitted to be issued after <code>OnDone</code> is invoked.</li>
<li><strong>IMPORTANT USAGE NOTE</strong> : code in any reaction must not block for an arbitrary amount of time since reactions are executed on a finite-sized, library-controlled threadpool. If any long-term blocking operations (like sleeps, file I/O, synchronous RPCs, or waiting on a condition variable) must be invoked as part of the application logic, then it is important to push that outside the reaction so that the reaction can complete in a timely fashion. One way of doing this is to push that code to a separate application-controlled thread.</li>
<li>RPC completion-prevention methods. These are methods provided by the class and are not virtual. They are only present at the client-side because the completion of a server RPC is clearly requested when the application invokes <code>Finish</code>. These methods are invoked by the application logic. All of these have a <code>void</code> return type.</li>
<li><code>void AddHold()</code>: (<em>Client only</em>) This prevents the RPC from being considered complete (ready for <code>OnDone</code>) until each <code>AddHold</code> on an RPC's reactor is matched to a corresponding <code>RemoveHold</code>. An application uses this operation before it performs any  <em>extra-reaction flows</em>, which refers to streaming operations initiated from outside a reaction method. Note that an RPC cannot complete before <code>StartCall</code>, so holds are not needed for any extra-reaction flows that take place before <code>StartCall</code>. As long as there are any holds present on an RPC, though, it may not have <code>OnDone</code> called on it, even if it has already received server status and has no other operations outstanding. May be called 0 or more times on any client RPC.</li>
<li><code>void AddMultipleHolds(int holds)</code>: (<em>Client only</em>) Shorthand for <code>holds</code> invocations of <code>AddHold</code> .</li>
<li><code>void RemoveHold()</code>: (<em>Client only</em>) Removes a hold reference on this client RPC. Must be called exactly as many times as <code>AddHold</code> was called on the RPC, and may not be called more times than <code>AddHold</code> has been called so far for any RPC. Once all holds have been removed, the server has provided status, and all outstanding or required operations have completed for an RPC, the library will invoke <code>OnDone</code> for that RPC.</li>
</ol>
<p>Examples are provided in <a href="https://github.com/grpc/grpc/pull/25728">the PR to de-experimentalize the callback API</a>.</p>
<h3 id="unary-rpc-shortcuts">Unary RPC shortcuts<a class="headerlink" href="#unary-rpc-shortcuts" title="Permanent link">&para;</a></h3>
<p>As a shortcut, client-side unary RPCs <em>may</em> bypass the reactor model by directly providing a <code>std::function</code> for the library to call at completion rather than a reactor object pointer. This is passed as the final argument to the stub call, just as the reactor would be in the more general case. This is semantically equivalent to a reactor in which the <code>OnDone</code> function simply invokes the specified function (but can be implemented in a slightly faster way since such an RPC will definitely not wait separately for initial metadata from the server) and all other reactions are left empty. In practice, this is the common and recommended model for client-side unary RPCs, unless they have a specific need to wait for initial metadata before getting their full response message. As in the reactor model, the function provided as a callback may not include operations that block for an arbitrary amount of time.</p>
<p>Server-side unary RPCs have the option of returning a library-provided default reactor when their method handler is invoked. This is provided by calling <a href="#servercontext-extensions"><code>DefaultReactor</code> on the <code>CallbackServerContext</code></a>. This default reactor provides a <code>Finish</code> method, but does not provide a user callback for <code>OnCancel</code> and <code>OnDone</code>. In practice, this is the common and recommended model for most server-side unary RPCs unless they specifically need to react to an <code>OnCancel</code> callback or do cleanup work after the RPC fully completes.</p>
<h3 id="servercontext-extensions">ServerContext extensions<a class="headerlink" href="#servercontext-extensions" title="Permanent link">&para;</a></h3>
<p><code>ServerContext</code> is now made a derived class of <code>ServerContextBase</code>. There is a new derived class of <code>ServerContextBase</code> called <code>CallbackServerContext</code> which provides a few additional functions:</p>
<ul>
<li><code>ServerUnaryReactor* DefaultReactor()</code> may be used by a method handler to return a default reactor from a unary RPC.</li>
<li><code>RpcAllocatorState* GetRpcAllocatorState</code>: see advanced topics section</li>
</ul>
<p>Additionally, the <code>AsyncNotifyWhenDone</code> function is not present in the <code>CallbackServerContext</code>.</p>
<p>All method handler functions for the callback API take a <code>CallbackServerContext*</code> as their first argument. <code>ServerContext</code> (used for the sync and CQ-based async APIs) and <code>CallbackServerContext</code> (used for the callback API) actually use the same underlying structure and thus their object pointers are meaningfully convertible to each other via a <code>static_cast</code> to <code>ServerContextBase*</code>. We recommend that any helper functions that need to work across API variants should use a <code>ServerContextBase</code> pointer or reference as their argument rather than a <code>ServerContext</code> or <code>CallbackServerContext</code> pointer or reference. For example, <code>ClientContext::FromServerContext</code> now uses a <code>ServerContextBase*</code> as its argument; this is not a breaking API change since the argument is now a parent class of the previous argument's class.</p>
<h3 id="advanced-topics">Advanced topics<a class="headerlink" href="#advanced-topics" title="Permanent link">&para;</a></h3>
<h4 id="application-managed-server-memory-allocation">Application-managed server memory allocation<a class="headerlink" href="#application-managed-server-memory-allocation" title="Permanent link">&para;</a></h4>
<p>Callback services must allocate an object for the <code>CallbackServerContext</code> and for the request and response objects of a unary call.  Applications can supply a per-method custom memory allocator for gRPC server to use to allocate and deallocate the request and response messages, as well as a per-server custom memory allocator for context objects. These can be used for purposes like early or delayed release, freelist-based allocation, or arena-based allocation. For each unary RPC method, there is a generated method in the server called <code>SetMessageAllocatorFor_*MethodName*</code> . For each server, there is a method called <code>SetContextAllocator</code>. Each of these has numerous classes involved, and the best examples for how to use these features lives in the gRPC tests directory.</p>
<ul>
<li><a href="https://github.com/grpc/grpc/blob/master/test/cpp/end2end/message_allocator_end2end_test.cc">Message allocator usage example</a></li>
<li><a href="https://github.com/grpc/grpc/blob/master/test/cpp/end2end/context_allocator_end2end_test.cc">Context allocator usage example</a></li>
</ul>
<h4 id="generic-non-code-generated-services">Generic (non-code-generated) services<a class="headerlink" href="#generic-non-code-generated-services" title="Permanent link">&para;</a></h4>
<p><code>RegisterCallbackGenericService</code> is a new method of <code>ServerBuilder</code> to allow for processing of generic (unparsed) RPCs. This is similar to the pre-existing <code>RegisterAsyncGenericService</code> but uses the callback API and reactors rather than the CQ-based async API. It is expected to be used primarily for generic gRPC proxies where the exact serialization format or list of supported methods is unknown.</p>
<h4 id="per-method-specification">Per-method specification<a class="headerlink" href="#per-method-specification" title="Permanent link">&para;</a></h4>
<p>Just as with async services, callback services may also be specified on a method-by-method basis (using the syntax <code>WithCallbackMethod_*MethodName*</code>), with any unlisted methods being treated as sync RPCs. The shorthand <code>CallbackService</code> declares every method as being processed by the callback API. For example:</p>
<ul>
<li><code>Foo::Service</code> -- purely synchronous service</li>
<li><code>Foo::CallbackService</code> -- purely callback service</li>
<li><code>Foo::WithCallbackMethod_Bar&lt;Service&gt;</code> -- synchronous service except for callback method <code>Bar</code></li>
<li><code>Foo::WithCallbackMethod_Bar&lt;WithCallbackMethod_Baz&lt;Service&gt;&gt;</code> -- synchronous service except for callback methods <code>Bar</code> and <code>Baz</code></li>
</ul>
<h2 id="rationale">Rationale<a class="headerlink" href="#rationale" title="Permanent link">&para;</a></h2>
<p>Besides the content described in the background section, the rationale also includes early and consistent user demand for this feature as well as the fact that many users were simply spinning up a callback model on top of gRPC's completion queue-based asynchronous model.</p>
<h2 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h2>
<p>There is more than one mechanism available for implementing the background polling required by the C++ callback API. One has been implemented <a href="https://github.com/grpc/grpc/pull/25169">on top of the C++ completion queue API</a>. In this approach, the callback API uses a number of library-owned threads to call <code>Next</code> on an async CQ that is owned by the internal implementation. Currently, the thread count is automatically selected by the library with no user input and is set to half the system's core count, but no less than 2 and no more than 16. This selection is subject to change in the future based on our team's ongoing performance analysis and tuning efforts. Despite being built on the CQ-based async API, the developer using the callback API does not need to consider any of the CQ details (e.g., shutdown, polling, or even the existence of a CQ).</p>
<p>It is the gRPC team's intention that that implementation is only a temporary solution. A new structure called an <code>EventEngine</code> is being developed to provide the background threads needed for polling, and this sytem is also intended to provide a direct API for application use. This event engine would also allow the direct use of the <a href="https://github.com/grpc/proposal/blob/master/L68-core-callback-api.md">core callback API</a> that is currently only used by the Python async implementation. If this solution is adopted, there will be a new gRFC for it. This new implementation will not change the callback API at all but rather will only affect its performance. The C++ code for the callback API already has <code>if</code> branches in place to support the use of a poller that directly supplies the background threads, so the callback API will naturally layer on top of the <code>EventEngine</code> without further development effort.</p>
<h2 id="open-issues-if-applicable">Open issues (if applicable)<a class="headerlink" href="#open-issues-if-applicable" title="Permanent link">&para;</a></h2>
<p>N/A. The gRPC C++ callback API has been used internally at Google for two years now, and the code and API have evolved substantially during that period.</p>


  <nav class="md-tags" >
    
      
      
      
      
        <span class="md-tag">c</span>
      
    
      
      
      
      
        <span class="md-tag">cpp</span>
      
    
      
      
      
      
        <span class="md-tag">grpc</span>
      
    
  </nav>








  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-circle-arrow-up" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="m16 12-4-4-4 4M12 16V8"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../grammer-noun-of-noun/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 语法规则-名词修饰名词">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-arrow-left" viewBox="0 0 24 24"><path d="m12 19-7-7 7-7M19 12H5"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                语法规则-名词修饰名词
              </div>
            </div>
          </a>
        
        
          
          <a href="../grpc-learning/" class="md-footer__link md-footer__link--next" aria-label="Next: grpc 学习">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                grpc 学习
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-arrow-right" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 The authors

    </div>
  
  
    Made with
    <a href="https://zensical.org/" target="_blank" rel="noopener">
      Zensical
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      
      <script id="__config" type="application/json">{"annotate":null,"base":"..","features":["announce.dismiss","content.code.annotate","content.code.copy","content.code.select","content.footnote.tooltips","content.tabs.link","content.tooltips","navigation.footer","navigation.indexes","navigation.instant","navigation.instant.prefetch","navigation.path","navigation.sections","navigation.top","navigation.tracking","search.highlight"],"search":"../assets/javascripts/workers/search.5e1f2129.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
    
    
      <script src="../assets/javascripts/bundle.1193bd74.min.js"></script>
      
    
  </body>
</html>